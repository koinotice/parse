version: '3'

services:
#  node:
#    image: bitnami/node
#    command: "sh -c 'npm install && npm start'"
#    volumes:
#    - app:/app
  parse:
    build: ./parse

    ports:
    - 7311:1337
    env_file:
      - parse.env
    volumes:
    - ./parse/cloud:/app/cloud
  #      - ./parse/config:/parse-server/config
  #      - ./parse/scripts:/parse-server/scripts
  #    # volumes:
  #    #   - ./parse/scripts:/parse/scripts
  #    entrypoint: ['/parse-server/scripts/wait_for_postgres.sh']

  # mongodb:
  #   image: 'bitnami/mongodb:latest'
  #   ports:
  #     - "27017:27017"
  #   environment:
  #     - MONGODB_USERNAME=pmker
  #     - MONGODB_PASSWORD=Zheli123
  #     - MONGODB_DATABASE=pmker

  #     - ../mongo-entrypoint:/docker-entrypoint-initdb.d
  #  mongo:
  #     image: koinotice/mongo:latest
  #     environment:
  #       - AUTH=yes
  #       - MONGODB_ADMIN_USER=pmker
  #       - MONGODB_ADMIN_PASS=Zheli123
  #       - MONGODB_APPLICATION_DATABASE=pmker
  #       - MONGODB_APPLICATION_USER=user
  #       - MONGODB_APPLICATION_PASS=Zheli123
  #     ports:
  #       - 27017:27017
  #     volumes:
  #     - ./db:/data/db

  mongo:
    image: 'bitnami/mongodb:latest'
    ports:
    - "27017:27017"
    environment:
    - MONGODB_ROOT_PASSWORD=Zheli123
    - MONGODB_USERNAME=pmker
    - MONGODB_PASSWORD=Zheli123
    - MONGODB_DATABASE=pmker
    volumes:
    - './data:/bitnami'


  postgresql:
    image: 'bitnami/postgresql:latest'
    ports:
    - '5432:5432'
    environment:
    - POSTGRESQL_USERNAME=pmker
    - POSTGRESQL_PASSWORD=Zheli123
    - POSTGRESQL_DATABASE=pmker
    volumes:
    - './data:/bitnami'

    #    container_name: postgres
    #    image: postgres:latest
    ##    env_file:
    ##      - .env
    #    expose:
    #    - 5432
    #    ports:
    #      - ${POSTGRES_PORT}:5432
    #
    #    environment:
    #    - POSTGRES_DB=${POSTGRES_DB}
    #    - POSTGRES_USER=${POSTGRES_USER}
    #    - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
    #
    #    volumes:
    #    - ${POSTGRES_HOST_DIR}:/var/lib/postgresql/data
    #      - target: 5433 # inside container
  #        published: 5432
  #        protocol: tcp # tcp / udp
  #        mode: host # use ingress for swarm load balancing
  #  mongo:
  #    container_name: mongo
  #    image: mongo
  #    volumes:
  #    - ./data:/data/db
  #    ports:
  #    - "27017:27017"
  #  mongo:
  #    image: mongo
  #    restart: always
  #    ports:
  #      - 27017:27017
  #    env_file:
  #      - .env
  #    volumes:
  #      - ./db:/data/db
  #      #- ./**script-folder**/:/docker-entrypoint-initdb.d
  #      # - ./mongo/data/db:/data/db
  ##      - ./mongo/docker-entrypoint-initdb:/docker-entrypoint-initdb.d
  ##      - ./mongo/scripts:/scripts/
  #    # environment:
  #    #   MONGO_INITDB_ROOT_USERNAME: root
  #    #   MONGO_INITDB_ROOT_PASSWORD: Zheli123
  redis:
    image: 'bitnami/redis:latest'
    ports:
    - '7379:6379'
    environment:
    - REDIS_PASSWORD=Zheli123
    volumes:

    - ./data/redis:/bitnami/redis/data
  #  redis:
  #    image: redis:${REDIS_VERSION}
  #    ports:
  #    - "${REDIS_HOST_PORT}:6379"
  #    volumes:
  #    - ${REDIS_CONF_FILE}:/etc/redis.conf:ro
  #    restart: always
  #    entrypoint: ["redis-server", "/etc/redis.conf"]

  #  phpredisadmin:
  #    image: erikdubbelboer/phpredisadmin:latest
  #    ports:
  #    - "${REDISMYADMIN_HOST_PORT}:80"
  #
  #    environment:
  #    - REDIS_1_HOST=redis
  #    - REDIS_1_PORT=6379

  #  lab:
  #    #build: ./lab
  #    image: posquit0/koa-rest-api-boilerplate
  #    ports:
  #    - 5555:7071
  #    environment:
  #      - PORT=7071
  #    # volumes:
  #    # - ./hash/src:/var/www/app/src
  ##
  #  hash:
  #    build: ./hash
  #    #image: hash:latest
  #    ports:
  #    - 5588:8000
  #    volumes:
  #    - ./hash/src:/var/www/app/src
  ##    environment:
  ##    - REDIS_URL=redis://redis:7379
  ##    - NODE_ENV=development
  ##    - PORT=3000
  #




  # mongo-express:
  #   image: mongo-express
  #   restart: always
  #   ports:
  #     - 8081:8081
  #   environment:
  #     ME_CONFIG_MONGODB_ADMINUSERNAME: root
  #     ME_CONFIG_MONGODB_ADMINPASSWORD: Zheli123

networks:
  default:
    external:
      name: ${GENV_DOCKER_NETWORK}